<?xml version='1.0' encoding='UTF-8' ?> 
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:c="http://xmlns.jcp.org/jsp/jstl/core"
      xmlns:f="http://xmlns.jcp.org/jsf/core">

    <h:head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet"/>
        <h:outputStylesheet name="./css/materialize.css"/>

        <title>Facelets Template</title>


    </h:head>

    <h:body>
        <!--Import jQuery before materialize.js-->
        <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
        <script type="text/javascript" src="js/materialize.min.js"></script>
        <script>
            $(window).scroll(
                    function () {
                        if ($(window).scrollTop() > 50) {
                            $("#prueba").removeClass("navScroll2");
                            $("#prueba").addClass("navScroll");
                        } else {
                            $("#prueba").removeClass("navScroll");
                            $("#prueba").addClass("navScroll2");
                        }
                    }
            );
            $(document).ready(function () {
                $(".optionStatusList").click(function () {
                    var x = document.getElementsByClassName("active");
                    x[1].className = "optionStatusList"
                    this.className += " active";
                });
            });
            $(document).ready(function () {
                $(".platformStatusList").click(function () {
                    var x = document.getElementsByClassName("active");
                    x[0].className = "platformStatusList"
                    this.className += " active";
                });
            });
        </script>

        <script>
            function loadData(panel) {
                if ((panel.scrollTop + panel.clientHeight) >= panel.scrollHeight) {
                    document.getElementById("form:data-loader").click();
                }
            }
            function ajaxEvent(data) {
                var status = data.status;
                if (status == "begin") {
                    document.getElementById("ajax-loader").style.display = "block";
                } else if (status == "complete") {
                    document.getElementById("ajax-loader").style.display = "none";
                }
            }
        </script>

        <script>
            $(document).ready(function () {
                $('.carousel').carousel();
            });
        </script>

        <ui:insert name="top">
            <h:form>
                <div class="navbar-fixed navScroll2" id="prueba">
                    <!-- Dropdown Structure -->
                    <ul id="dropdown1" class="dropdown-content">
                        <li>
                            <h:form id="form01" rendered="#{request.isUserInRole('user') or request.isUserInRole('admin')}">
                                <a href="#!"><i class="material-icons left">perm_identity</i>#{sessionBean.nombre}</a>
                            </h:form>
                        </li>
                        <li class="divider"></li>
                        <li><h:link value="Configuración" style="width: 200'px"></h:link></li>
                        <li>
                            <h:commandLink value="Cerrar sesión" actionListener="#{sessionBean.logout()}" rendered="#{request.isUserInRole('user') or request.isUserInRole('admin') or request.isUserInRole('community')}"></h:commandLink>
                        </li>

                    </ul>

                    <nav class="nav-extended">
                        <a href="#" data-activates="slide-out" class="button-collapse"><i class="material-icons">menu</i></a>
                        <div class="nav-wrapper grey darken-4" >

                            <h:link value="VideoGames" class="brand-logo" style="padding-left: 10px" outcome="index"/>
                            <ul class="right hide-on-med-and-down">
                                <li><h:link value="Registrarse" outcome="registrarUsuario.xhtml" rendered="#{not request.isUserInRole('user') and not request.isUserInRole('admin')}"><i class="material-icons left">assignment_ind</i></h:link></li>
                                <li><h:link value="Iniciar sesión" outcome="login.xhtml" rendered="#{not request.isUserInRole('user') and not request.isUserInRole('admin')}"><i class="material-icons left">perm_identity</i></h:link></li>
                                <li>
                                    <h:outputLink rendered="#{request.isUserInRole('user') or request.isUserInRole('admin') or request.isUserInRole('community')}">
                                        <a class="dropdown-button" href="#!" data-activates="dropdown1"><i class="material-icons left">verified_user</i><i class="material-icons right">arrow_drop_down</i>#{sessionBean.nombre}</a>
                                    </h:outputLink>
                                </li> 
                            </ul>
                        </div>
                        <div class="nav-content grey darken-1">
                            <ul class="tabs tabs-transparent">
                                <h:form>
                                    <ui:repeat value="#{menuNavPlataformBean.names}" var = "platform" varStatus="status">
                                        <ui:fragment rendered ="#{status.index eq 0}">
                                            <li class="tab "><h:link class="platformStatusList active" value ="#{platform}" outcome="main.xhtml"></h:link></li>
                                        </ui:fragment>
                                        <ui:fragment rendered ="#{status.index ne 0}">
                                            <li class="tab "><h:link class = "platformStatusList" value ="#{platform}" outcome="main.xhtml"></h:link> </li>
                                        </ui:fragment>
                                    </ui:repeat>
                                </h:form>
                            </ul>
                        </div>
                        <div class="nav-content grey">
                            <ul class="tabs tabs-transparent">
                                <li class="tab "><a class="optionStatusList active" href="#!">Juegos</a></li>
                                <li class="tab "><a class="optionStatusList" href="#!">Noticias</a></li>
                                <li class="tab "><a class="optionStatusList" href="#!">Videos</a></li>
                                <li class="tab "><a class="optionStatusList" href="#!">Imagenes</a></li>
                            </ul>
                        </div>

                    </nav>
                </div>

            </h:form>

            <!--<div class="nav-content">
                <ul class="tabs tabs-transparent">
                    <li class="tab"><a href="#">Noticias</a></li>
                    <li class="tab"><a href="registrarUsuario.xhtml">Videojuegos</a></li>
                </ul>
            </div>-->
        </ui:insert>


        <ul id="slide-out" class="side-nav">
            <li><div class="userView">
                    <div class="background">
                        <img src="resources/images/img.jpg" style="max-height: 100%; max-width: 100%" />
                    </div>
                    <a href="#!user"><img class="circle" /></a>
                    <a href="#!name"><span class="white-text name">John Doe</span></a>
                    <a href="#!email"><span class="white-text email">jdandturk@gmail.com</span></a>
                </div></li>
            <li><a href="#!"><i class="material-icons">cloud</i>First Link With Icon</a></li>
            <li><a href="#!">Second Link</a></li>
            <li><div class="divider"></div></li>
            <li><a class="subheader">Subheader</a></li>
            <li><a class="waves-effect" href="#!">Third Link With Waves</a></li>
        </ul>

        <h:form>
            <p/>
            <div class="carousel">
                <ui:repeat value="#{carouselBean.images}" var = "image" varStatus="status">
                    <a class="carousel-item" href="#one!"><img src="#{image}" style="position: relative;float: left;width:  200px;height: 250px;background-position: 50% 50%;background-repeat:no-repeat;background-size:cover;"/></a>
                </ui:repeat>
            </div>

            <p/>

        </h:form>

        <h:form id="loaded-data">
            <div class="container" style="margin-top: 10%">
                <div id="data-scroller-panel" onscroll="loadData(this);">
                    <ui:repeat value="#{dataScrollerBean.gameList}" var="gl">
                        <div class="card horizontal" style="width: 100%">
                            <div class="card-image">
                                <img src="#{gl.profileImage}" style="position: relative;float: left;width:  200px;height: 250px;background-position: 50% 50%;background-repeat:no-repeat;background-size:cover;"/>
                            </div>
                            <div class="card-stacked">
                                <div class="card-content">
                                    <p>#{gl.description}</p>
                                </div>
                                <div class="card-action">
                                    <a href="#">#{gl.title}</a>
                                </div>
                            </div>
                        </div>
                    </ui:repeat>
                </div>
                <!--<img src="ajax-loader.gif" id="ajax-loader" style="display: none;"/>-->
                <div id="ajax-loader" class="progress" style="display: none">
                    <div class="indeterminate"></div>
                </div>

                <p>#{dataScrollerBean.countLoaded} / #{dataScrollerBean.countTotal}</p>

                <h:commandButton id="data-loader" class="btn waves-effect waves-ligh" value="Load Data" action="#{dataScrollerBean.loadData()}">
                    <f:ajax onevent="ajaxEvent" render="loaded-data"/>
                </h:commandButton>
            </div>
        </h:form>


        <div style="margin-left: 5%; margin-top: 2%; margin-bottom: 3%">
            <ui:insert name="content">Content</ui:insert>
        </div>


        <ui:insert name="bottom">

            <footer class="page-footer grey darken-4">
                <div class="container">
                    <div class="row">
                        <div class="col l6 s12">
                            <h5 class="white-text">Footer Content</h5>
                            <p class="grey-text text-lighten-4">You can use rows and columns here to organize your footer content.</p>
                        </div>
                        <div class="col l4 offset-l2 s12">
                            <h5 class="white-text">Links</h5>
                            <ul>
                                <li><a class="grey-text text-lighten-3" href="#!">Link 1</a></li>
                                <li><a class="grey-text text-lighten-3" href="#!">Link 2</a></li>
                                <li><a class="grey-text text-lighten-3" href="#!">Link 3</a></li>
                                <li><a class="grey-text text-lighten-3" href="#!">Link 4</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="footer-copyright">
                    <div class="container">
                        © 2017 Aplicaciones Web
                        <a class="grey-text text-lighten-4 right" href="#!">More Links</a>
                    </div>
                </div>
            </footer>
        </ui:insert>


        <!-- JavaScript -->
        <h:outputScript library="primefaces" name="jquery/jquery.js"/>
        <h:outputScript library="js" name="materialize.js" />

        <script>
            // Initialize collapse button
            $(".button-collapse").sideNav();

            jQuery(document).ready(function ()
            {
                $(".dropdown-button").dropdown();
            });
        </script>

    </h:body>

</html>
